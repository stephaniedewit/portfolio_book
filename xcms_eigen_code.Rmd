## Deel 2: ...

```{r}
# Maak een variabele met de paden naar de vier te analyseren files:
cdfs <- dir(system.file("cdf", package = "faahKO"), full.names = TRUE, recursive = TRUE)[c(3, 4, 9, 10)] ## full.names en recursive voor paden i.p.v. bestandsnamen

# Maak een phenodata dataframe:
pd <- data.frame(sample_name = sub(basename(cdfs), pattern = ".CDF", replacement = "", fixed = TRUE), sample_group = c(rep("KO", 2), rep("WT", 2)), stringsAsFactors = FALSE) ## sub() verwijdert .CDF uit naam, stringsAsFactors = FALSE geeft aan dat er geen factors gemaakt moeten worden van de character vectors
pd

# Laad de ruwe data:
raw_data <- readMSData(files = cdfs, pdata = new("NAnnotatedDataFrame", pd), mode = "onDisk") ## het pdata argument vraagt naar een AnnotatedDataFrame met metadata, onDisk zodat de ruwe data niet opgeslagen wordt in het geheugen (i.v.m. analyse snelheid)

# Onderzoek raw_data:
#View(raw_data)
head(rtime(raw_data))
#head(intensity(raw_data), 2) ## output te groot
#head(mz(raw_data), 2) ## output te groot

per_file <- split(c( rtime(raw_data), mz(raw_data), intensity(raw_data)), f = fromFile(raw_data))
length(per_file)
#View(per_file)

# Verkrijg BPC:
bpis <- chromatogram(raw_data, aggregationFun = "max")  
group_colors <- brewer.pal(4, "Set1")[3:4] ## geef KO een groene kleur en WT een paarse kleur
names(group_colors) <- c("KO", "WT")

# Verkrijg TIC:
bpis_2 <- chromatogram(raw_data, aggregationFun = "sum")

# Plot chromatogrammen:
plot(bpis, col = group_colors[raw_data$sample_group], main = "Base peak chromatogram per monster: m/z ratio range: 200 - 600")
legend(4000, 1000000, legend = c("ko18", "ko19", "wt18", "wt19"), lty = 1, col = c(rep("green", 2), rep("purple", 2)))

plot(bpis_2, col = group_colors[raw_data$sample_group], main = "Total ion chromatogram per monster: m/z ratio range: 200 - 600")
legend(4000, 2100000, legend = c("ko18", "ko19", "wt18", "wt19"), lty = 1, col = c(rep("green", 2), rep("purple", 2)))

# Bekijk hoe de ion currents per monster verdeeld zijn:
tc <- split(tic(raw_data), f = fromFile(raw_data)) ## file splitsen op total ion currents per monster
boxplot(tc, col = group_colors[raw_data$sample_group], ylab = "intensity", main = "Total ion current per monster", names = c("ko18", "ko19", "wt18", "wt19"))


```

